<!DOCTYPE html>
<html lang="en" >
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1" />
Â  <title>Admin Task Management</title>
Â  <script src="https://cdn.tailwindcss.com"></script>
Â  <link
Â  Â  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
Â  Â  rel="stylesheet"
Â  />
</head>
<body class="bg-gradient-to-br from-indigo-50 to-white min-h-screen text-gray-900">

Â  <main class="max-w-5xl mx-auto p-6 sm:p-10">
Â  Â  <h1 class="text-4xl font-extrabold mb-10 text-center text-indigo-700 drop-shadow-sm select-none">
Â  Â  Â  ğŸ› ï¸ Manage Tasks
Â  Â  </h1>

Â  Â  <section
Â  Â  Â  class="mb-12 bg-white rounded-xl shadow-lg p-8 max-w-lg mx-auto sm:mx-0 sm:max-w-none"
Â  Â  Â  aria-label="Add or edit a task"
Â  Â  >
Â  Â  Â  <h2 class="text-2xl font-semibold mb-6 text-indigo-800 border-b border-indigo-200 pb-2">
Â  Â  Â  Â  Add / Edit Task
Â  Â  Â  </h2>

Â  Â  Â  <form id="taskForm" class="space-y-6">
Â  Â  Â  Â  <input type="hidden" id="taskId" value="" />

Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <label
Â  Â  Â  Â  Â  Â  for="taskName"
Â  Â  Â  Â  Â  Â  class="block mb-2 font-medium text-indigo-700"
Â  Â  Â  Â  Â  Â  >Task Name <span class="text-red-500">*</span></label
Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  <input
Â  Â  Â  Â  Â  Â  type="text"
Â  Â  Â  Â  Â  Â  id="taskName"
Â  Â  Â  Â  Â  Â  placeholder="Enter task name"
Â  Â  Â  Â  Â  Â  class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-gray-900 placeholder-indigo-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition"
Â  Â  Â  Â  Â  Â  required
Â  Â  Â  Â  Â  />
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <label
Â  Â  Â  Â  Â  Â  for="taskDesc"
Â  Â  Â  Â  Â  Â  class="block mb-2 font-medium text-indigo-700"
Â  Â  Â  Â  Â  Â  >Description</label
Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  <textarea
Â  Â  Â  Â  Â  Â  id="taskDesc"
Â  Â  Â  Â  Â  Â  placeholder="Enter task description (optional)"
Â  Â  Â  Â  Â  Â  class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-gray-900 placeholder-indigo-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition resize-none"
Â  Â  Â  Â  Â  Â  rows="4"
Â  Â  Â  Â  Â  ></textarea>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <label
Â  Â  Â  Â  Â  Â  for="taskReward"
Â  Â  Â  Â  Â  Â  class="block mb-2 font-medium text-indigo-700"
Â  Â  Â  Â  Â  Â  >Reward Amount (à§³) <span class="text-red-500">*</span></label
Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  <input
Â  Â  Â  Â  Â  Â  type="number"
Â  Â  Â  Â  Â  Â  id="taskReward"
Â  Â  Â  Â  Â  Â  placeholder="Enter reward amount (e.g. 5)"
Â  Â  Â  Â  Â  Â  class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-gray-900 placeholder-indigo-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition"
Â  Â  Â  Â  Â  Â  min="0"
Â  Â  Â  Â  Â  Â  step="0.01"
Â  Â  Â  Â  Â  Â  required
Â  Â  Â  Â  Â  />
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <label
Â  Â  Â  Â  Â  Â  for="taskView"
Â  Â  Â  Â  Â  Â  class="block mb-2 font-medium text-indigo-700"
Â  Â  Â  Â  Â  Â  >View Name (URL)</label
Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  <input
Â  Â  Â  Â  Â  Â  type="url"
Â  Â  Â  Â  Â  Â  id="taskView"
Â  Â  Â  Â  Â  Â  placeholder="Enter view link (e.g. https://example.com)"
Â  Â  Â  Â  Â  Â  class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-gray-900 placeholder-indigo-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition"
Â  Â  Â  Â  Â  />
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="flex flex-col sm:flex-row gap-4 justify-center">
Â  Â  Â  Â  Â  <button
Â  Â  Â  Â  Â  Â  type="submit"
Â  Â  Â  Â  Â  Â  class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold px-8 py-3 rounded-lg shadow-md transition focus:outline-none focus:ring-4 focus:ring-indigo-400"
Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Save Task
Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  <button
Â  Â  Â  Â  Â  Â  type="button"
Â  Â  Â  Â  Â  Â  id="resetBtn"
Â  Â  Â  Â  Â  Â  class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold px-8 py-3 rounded-lg shadow-md transition focus:outline-none focus:ring-4 focus:ring-gray-400"
Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Reset
Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>
Â  Â  Â  </form>
Â  Â  </section>

Â  Â  <section aria-label="List of all tasks">
Â  Â  Â  <h2
Â  Â  Â  Â  class="text-2xl font-semibold mb-6 text-indigo-800 border-b border-indigo-200 pb-2 max-w-2xl mx-auto"
Â  Â  Â  >
Â  Â  Â  Â  All Tasks
Â  Â  Â  </h2>
Â  Â  Â  <div
Â  Â  Â  Â  id="tasksList"
Â  Â  Â  Â  class="space-y-5 max-w-4xl mx-auto"
Â  Â  Â  Â  role="list"
Â  Â  Â  Â  aria-live="polite"
Â  Â  Â  >
Â  Â  Â  Â  <p class="text-center text-indigo-400 italic">Loading tasks...</p>
Â  Â  Â  </div>
Â  Â  </section>
Â  </main>

Â  <script type="module">
Â  Â  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
Â  Â  import {
Â  Â  Â  getFirestore,
Â  Â  Â  collection,
Â  Â  Â  getDocs,
Â  Â  Â  doc,
Â  Â  Â  setDoc,
Â  Â  Â  deleteDoc,
Â  Â  Â  onSnapshot,
Â  Â  } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
Â  Â  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

Â  Â  const firebaseConfig = {
Â  Â  Â  apiKey: "AIzaSyCkYWvYNsg2-CR88Js6gcP2nXfvwI4TW30",
Â  Â  Â  authDomain: "bdwork-346d3.firebaseapp.com",
Â  Â  Â  projectId: "bdwork-346d3",
Â  Â  Â  storageBucket: "bdwork-346d3.appspot.com",
Â  Â  Â  messagingSenderId: "900963179093",
Â  Â  Â  appId: "1:900963179093:web:81e42d67bb31d603cc92dc",
Â  Â  Â  measurementId: "G-FM1YJ8E5GK",
Â  Â  };

Â  Â  const app = initializeApp(firebaseConfig);
Â  Â  const db = getFirestore(app);
Â  Â  const auth = getAuth(app);

Â  Â  const tasksCol = collection(db, "tasks");
Â  Â  const tasksList = document.getElementById("tasksList");
Â  Â  const taskForm = document.getElementById("taskForm");
Â  Â  const taskIdInput = document.getElementById("taskId");
Â  Â  const taskNameInput = document.getElementById("taskName");
Â  Â  const taskDescInput = document.getElementById("taskDesc");
Â  Â  const taskRewardInput = document.getElementById("taskReward");
Â  Â  const taskViewInput = document.getElementById("taskView");
Â  Â  const resetBtn = document.getElementById("resetBtn");

Â  Â  onAuthStateChanged(auth, (user) => {
Â  Â  Â  if (!user) {
Â  Â  Â  Â  alert("Please log in first.");
Â  Â  Â  Â  window.location.href = "login.html";
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â  loadTasksRealtime();
Â  Â  });

Â  Â  function loadTasksRealtime() {
Â  Â  Â  onSnapshot(tasksCol, (snapshot) => {
Â  Â  Â  Â  if (snapshot.empty) {
Â  Â  Â  Â  Â  tasksList.innerHTML =
Â  Â  Â  Â  Â  Â  '<p class="text-center text-indigo-500 italic">No tasks found.</p>';
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  tasksList.innerHTML = "";
Â  Â  Â  Â  snapshot.forEach((docSnap) => {
Â  Â  Â  Â  Â  const task = { id: docSnap.id, ...docSnap.data() };
Â  Â  Â  Â  Â  const taskDiv = document.createElement("div");
Â  Â  Â  Â  Â  taskDiv.className =
Â  Â  Â  Â  Â  Â  "p-5 bg-white rounded-xl shadow-md flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 sm:gap-0";

Â  Â  Â  Â  Â  const info = document.createElement("div");
Â  Â  Â  Â  Â  info.className = "flex-1 min-w-0";

Â  Â  Â  Â  Â  info.innerHTML = `
Â  Â  Â  Â  Â  Â  <p class="font-semibold text-lg text-indigo-700 truncate">${task.name}</p>
Â  Â  Â  Â  Â  Â  <p class="text-gray-600 text-sm mt-1 line-clamp-2">${task.description || ""}</p>
Â  Â  Â  Â  Â  Â  <p class="mt-2 font-semibold text-indigo-600">Reward: à§³${task.reward?.toFixed(2) || "0.00"}</p>
Â  Â  Â  Â  Â  Â  ${
Â  Â  Â  Â  Â  Â  Â  task.view
Â  Â  Â  Â  Â  Â  Â  Â  ? `<p class="mt-1"><a href="${task.view}" target="_blank" rel="noopener noreferrer" class="text-blue-600 underline hover:text-blue-800">View</a></p>`
Â  Â  Â  Â  Â  Â  Â  Â  : ""
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  `;

Â  Â  Â  Â  Â  const controls = document.createElement("div");
Â  Â  Â  Â  Â  controls.className = "flex gap-3 justify-end";

Â  Â  Â  Â  Â  const editBtn = document.createElement("button");
Â  Â  Â  Â  Â  editBtn.className =
Â  Â  Â  Â  Â  Â  "bg-yellow-400 hover:bg-yellow-500 px-4 py-2 rounded-lg text-white transition shadow-md focus:outline-none focus:ring-2 focus:ring-yellow-300";
Â  Â  Â  Â  Â  editBtn.innerHTML = `<i class="fas fa-edit"></i> Edit`;
Â  Â  Â  Â  Â  editBtn.title = "Edit Task";
Â  Â  Â  Â  Â  editBtn.onclick = () => {
Â  Â  Â  Â  Â  Â  taskIdInput.value = task.id;
Â  Â  Â  Â  Â  Â  taskNameInput.value = task.name;
Â  Â  Â  Â  Â  Â  taskDescInput.value = task.description || "";
Â  Â  Â  Â  Â  Â  taskRewardInput.value = task.reward;
Â  Â  Â  Â  Â  Â  taskViewInput.value = task.view || "";
Â  Â  Â  Â  Â  Â  window.scrollTo({ top: 0, behavior: "smooth" });
Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  const deleteBtn = document.createElement("button");
Â  Â  Â  Â  Â  deleteBtn.className =
Â  Â  Â  Â  Â  Â  "bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg text-white transition shadow-md focus:outline-none focus:ring-2 focus:ring-red-400";
Â  Â  Â  Â  Â  deleteBtn.innerHTML = `<i class="fas fa-trash"></i> Delete`;
Â  Â  Â  Â  Â  deleteBtn.title = "Delete Task";
Â  Â  Â  Â  Â  deleteBtn.onclick = async () => {
Â  Â  Â  Â  Â  Â  if (
Â  Â  Â  Â  Â  Â  Â  confirm(
Â  Â  Â  Â  Â  Â  Â  Â  `Delete task "${task.name}"? This action cannot be undone.`
Â  Â  Â  Â  Â  Â  Â  )
Â  Â  Â  Â  Â  Â  ) {
Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  await deleteDoc(doc(db, "tasks", task.id));
Â  Â  Â  Â  Â  Â  Â  Â  alert("Task deleted.");
Â  Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  alert("Error deleting task: " + error.message);
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  controls.appendChild(editBtn);
Â  Â  Â  Â  Â  controls.appendChild(deleteBtn);

Â  Â  Â  Â  Â  taskDiv.appendChild(info);
Â  Â  Â  Â  Â  taskDiv.appendChild(controls);
Â  Â  Â  Â  Â  tasksList.appendChild(taskDiv);
Â  Â  Â  Â  });
Â  Â  Â  });
Â  Â  }

Â  Â  function resetForm() {
Â  Â  Â  taskIdInput.value = "";
Â  Â  Â  taskNameInput.value = "";
Â  Â  Â  taskDescInput.value = "";
Â  Â  Â  taskRewardInput.value = "";
Â  Â  Â  taskViewInput.value = "";
Â  Â  Â  taskNameInput.focus();
Â  Â  }

Â  Â  resetBtn.addEventListener("click", resetForm);

Â  Â  taskForm.addEventListener("submit", async (e) => {
Â  Â  Â  e.preventDefault();

Â  Â  Â  const id = taskIdInput.value.trim();
Â  Â  Â  const name = taskNameInput.value.trim();
Â  Â  Â  const description = taskDescInput.value.trim();
Â  Â  Â  const reward = parseFloat(taskRewardInput.value);
Â  Â  Â  const view = taskViewInput.value.trim();

Â  Â  Â  if (!name) return alert("Task name is required.");
Â  Â  Â  if (isNaN(reward) || reward < 0)
Â  Â  Â  Â  return alert("Reward must be a valid non-negative number.");

Â  Â  Â  try {
Â  Â  Â  Â  if (id) {
Â  Â  Â  Â  Â  await setDoc(
Â  Â  Â  Â  Â  Â  doc(db, "tasks", id),
Â  Â  Â  Â  Â  Â  { name, description, reward, view },
Â  Â  Â  Â  Â  Â  { merge: true }
Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  alert("Task updated.");
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  await setDoc(doc(collection(db, "tasks")), {
Â  Â  Â  Â  Â  Â  name,
Â  Â  Â  Â  Â  Â  description,
Â  Â  Â  Â  Â  Â  reward,
Â  Â  Â  Â  Â  Â  view,
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  alert("Task added.");
Â  Â  Â  Â  }
Â  Â  Â  Â  resetForm();
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  alert("Error saving task: " + error.message);
Â  Â  Â  }
Â  Â  });
Â  </script>
</body>
  </html>
